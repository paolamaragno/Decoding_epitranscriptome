 params{
	// Path to the sample description file
        samples = "/work/pmaragno/sample_txt/samples_m6anet_fractions_4sU_10sampling.txt"

	// Path to a folder where to store results
	resultsDir = "/projects/CGS_shared/pmaragno/m6anet_fractions_4sU_10sampling"

	// Path to the transcriptome fasta
	transcriptome_fasta = "/work/pmaragno/references/Homo_sapiens.GRCh38.cdna.all.fa"

	// Gtf file
	gtf = "/work/pmaragno/references/Homo_sapiens.GRCh38.104.gtf"

	// Probability modification threshold for calling a site as m6A+
	prob_mod_thr = 0

	// Min MAPQ
        min_mapq = 0

	// Path to post-processing R script
	postprocessingScript = "/home/pmaragno/nf-m6anet/Transcript_to_genome.R"

	//Path to bulk level m6A estimator script
	bulkLevelScript = "/home/pmaragno/nf-m6anet/Calculate_m6anet_bulk.R"

	// Flags to select which process to run
	minimap2 = false
	nanopolish = true
	m6anet1 = true
	m6anet2 = true
	postprocessing = true
}

singularity {
	enabled = true
	autoMounts = false
	cacheDir = "/projects/CGS_shared/smaestri/singularity_cache/"
}

tower {
	enabled = true
	endpoint = '-'
	accessToken = 'eyJ0aWQiOiA3MTQ0fS42YmFkNTkwYjdmOWU5OTM4YjczNWRiZGE3ZDIxNWYzZDFiODc3MDFm'
}

profiles {
	singularity {
		singularity.enabled = true
		singularity.autoMounts = false
		//singularity.cacheDir = "/path/to/singularity/cacheDir" // if commented, work dir is going to be usedd
		process{
			containerOptions = '--bind /projects/CGS_shared/:/projects/CGS_shared --bind /work/pmaragno:/work/pmaragno/'
			cpus = 1
			executor = 'pbspro'
			queue = 'workq'
			perJobMemLimit = true
			clusterOptions = '-l walltime=120:00:00'
		withName:minimap2{
			container = 'mfurla/minimap2.26-r1175:v1'
			cpus = { params.minimap2 ? 10 : 1 }
			memory = { params.minimap2 ? 60.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}
		withName:nanopolish{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.nanopolish ? 10 : 1 }
			memory = { params.nanopolish ? 30.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}
		withName:m6anet1{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.m6anet1 ? 10 : 1 }
			memory = { params.m6anet1 ? 30.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}
		withName:m6anet2{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.m6anet2 ? 6 : 1 }
			memory = { params.m6anet2 ? 30.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}
		withName:postprocessing{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.postprocessing ? 6 : 1 }
			memory = { params.postprocessing ? 10.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}

	}
}


docker {
	    docker.enabled = true
	    docker.autoMounts = false
	    //docker.cacheDir = "/path/to/docker/cacheDir" // if commented, work dir is going to be used
	    process{
			containerOptions = '-v /home/:/home'
			cpus = 1
			executor = 'pbspro'
			queue = 'workq'
			perJobMemLimit = true
		withName:minimap2{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.minimap2 ? 6 : 1 }
			memory = { params.minimap2 ? 10.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}
		withName:nanopolish{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.nanopolish ? 6 : 1 }
			memory = { params.nanopolish ? 10.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}
		withName:m6anet1{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.m6anet1 ? 6 : 1 }
			memory = { params.m6anet1 ? 10.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}
		withName:m6anet2{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.m6anet2 ? 6 : 1 }
			memory = { params.m6anet2 ? 10.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}
		withName:postprocessing{
			container = 'maestsi/nf-m6anet:latest'
			cpus = { params.postprocessing ? 6 : 1 }
			memory = { params.postprocessing ? 10.GB + (2.GB * (task.attempt-1)) : 1.GB }
			errorStrategy = { task.exitStatus == 130 ? 'retry' : 'terminate' }
			maxRetries = 3
		}

	}
   }	
}
